<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<title>Gioco tempi di reazione</title>
<style>
  /* Stile contenitore carte e tabella */
  #cards { display:flex; gap:10px; margin-top:20px; }
  .card { width:50px; height:70px; border:2px solid #333; display:flex; justify-content:center; align-items:center; font-size:24px; cursor:pointer; user-select:none; }
  #leaderboard { margin-top:20px; border-collapse:collapse; max-width:300px; }
  #leaderboard th, #leaderboard td { border:1px solid #333; padding:5px 10px; text-align:left; }
  #leaderboard th { background:#eee; }
</style>
</head>
<body>
<h2>Gioco tempi di reazione</h2>
<!-- Form per inserire nome -->
<form id="form">
  Nome: <input type="text" id="name" required />
  <button>Inizia</button>
</form>

<!-- Contenitore per le carte -->
<div id="cards"></div>

<!-- Visualizzazione tempi -->
<p>Tempi (ms): <span id="times"></span></p>

<!-- Tabella classifica -->
<h3>Classifica</h3>
<table id="leaderboard">
<thead><tr><th>Nome</th><th>Tempo</th></tr></thead>
<tbody></tbody>
</table>

<script>
const cards = document.getElementById('cards'),
      timesSpan = document.getElementById('times'),
      form = document.getElementById('form'),
      nameInput = document.getElementById('name'),
      lbBody = document.querySelector('#leaderboard tbody');

let reactionTimes = [],   // Array per salvare i tempi
    startTime = 0,       // Tempo inizio manche
    intervalId,          // ID intervallo
    player = '',         // Nome giocatore corrente
    leaderboard = [];    // Array classifica {name, time}

/**
 * Genera 8 numeri unici casuali da 10 a 99
 * @returns {number[]}
 */
function randomNums() {
  const nums = new Set();
  while(nums.size < 8) nums.add(Math.floor(Math.random() * 90) + 10);
  return [...nums];
}

/**
 * Mostra le carte con i numeri e imposta eventi click
 */
function showCards() {
  cards.innerHTML = '';                      // Pulisce carte vecchie
  const nums = randomNums(),                 // Genera numeri
        minNum = Math.min(...nums);          // Trova numero minimo

  nums.forEach(num => {
    const c = document.createElement('div');
    c.className = 'card';
    c.textContent = num;

    // Evento click sulla carta
    c.onclick = () => {
      const reaction = Date.now() - startTime; // Calcola tempo reazione
      if(num === minNum) {                      // Se cliccato numero corretto
        reactionTimes.push(reaction);           // Salva tempo
        updateTimes();                          // Aggiorna visualizzazione tempi
        updateLeaderboard(player, reaction);   // Aggiorna classifica
        disableCards();                         // Disabilita carte fino a nuova manche
      } else {
        reactionTimes = [];                      // Se errore, reset tempi
        updateTimes();
        alert('Numero sbagliato! Tempi azzerati.');
      }
    };

    cards.appendChild(c);                       // Aggiunge carta al contenitore
  });

  startTime = Date.now();                       // Imposta tempo inizio manche
}

/**
 * Aggiorna lista tempi nella pagina
 */
function updateTimes() {
  timesSpan.textContent = reactionTimes.join(', ');
}

/**
 * Disabilita il click su tutte le carte
 */
function disableCards() {
  document.querySelectorAll('.card').forEach(c => c.onclick = null);
}

/**
 * Aggiorna la classifica con nuovo tempo
 * mantiene al massimo 10 record ordinati per tempo crescente
 * @param {string} name
 * @param {number} time
 */
function updateLeaderboard(name, time) {
  leaderboard.push({name, time});
  leaderboard.sort((a,b) => a.time - b.time);
  if(leaderboard.length > 10) leaderboard.pop();
  renderLeaderboard();
}

/**
 * Mostra la classifica aggiornata nella tabella
 */
function renderLeaderboard() {
  lbBody.innerHTML = '';
  leaderboard.forEach(r => {
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${r.name}</td><td>${r.time}</td>`;
    lbBody.appendChild(tr);
  });
}

/**
 * Avvia il gioco con manche ogni 3 secondi
 */
function startGame() {
  showCards();
  intervalId = setInterval(showCards, 3000);
}

/**
 * Gestione submit form nome
 */
form.onsubmit = e => {
  e.preventDefault();
  const n = nameInput.value.trim();
  if(!n) return alert('Inserisci un nome valido');
  player = n;
  form.style.display = 'none';   // Nasconde form
  startGame();
};
</script>
</body>
</html>
